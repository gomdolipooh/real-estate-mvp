<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firebase ì—°ê²° í…ŒìŠ¤íŠ¸</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 p-8">
  <div class="max-w-2xl mx-auto">
    <h1 class="text-2xl font-bold mb-4">Firebase ì—°ê²° í…ŒìŠ¤íŠ¸</h1>
    <div id="status" class="bg-white rounded-lg shadow p-6 mb-4">
      <p class="text-slate-600">í…ŒìŠ¤íŠ¸ ì¤‘...</p>
    </div>
    <div id="logs" class="bg-slate-900 text-green-400 rounded-lg p-4 font-mono text-sm max-h-96 overflow-y-auto"></div>
    <div class="mt-4">
      <button id="testWrite" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 mr-2">
        Firestore ì“°ê¸° í…ŒìŠ¤íŠ¸
      </button>
      <button id="testRead" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">
        Firestore ì½ê¸° í…ŒìŠ¤íŠ¸
      </button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import {
      getFirestore,
      collection,
      addDoc,
      getDocs,
      serverTimestamp,
    } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";
    import {
      getStorage,
    } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCUOvPVhd1zgVOJq3a88MeE4Ew1QgB42xU",
      authDomain: "vision-ac00e.firebaseapp.com",
      projectId: "vision-ac00e",
      storageBucket: "vision-ac00e.firebasestorage.app",
      messagingSenderId: "973829787287",
      appId: "1:973829787287:web:3ca6b7f51dceda8eb123d2",
      measurementId: "G-71PFXDK6S4",
    };

    const statusEl = document.getElementById("status");
    const logsEl = document.getElementById("logs");

    function log(message, type = "info") {
      console.log(message);
      const color = type === "error" ? "text-red-400" : type === "success" ? "text-green-400" : "text-blue-400";
      logsEl.innerHTML += `<div class="${color}">${new Date().toLocaleTimeString()} - ${message}</div>`;
      logsEl.scrollTop = logsEl.scrollHeight;
    }

    try {
      log("Firebase ì´ˆê¸°í™” ì‹œì‘...");
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const storage = getStorage(app);

      log("âœ… Firebase ì´ˆê¸°í™” ì„±ê³µ!", "success");
      log(`ğŸ“¦ Project ID: ${app.options.projectId}`);
      log(`ğŸ’¾ Storage Bucket: ${storage.app.options.storageBucket}`);

      statusEl.innerHTML = `
        <div class="text-green-600 font-semibold mb-2">âœ… Firebase ì—°ê²° ì„±ê³µ!</div>
        <div class="text-sm text-slate-600">
          <p>í”„ë¡œì íŠ¸: ${app.options.projectId}</p>
          <p>ë²„í‚·: ${storage.app.options.storageBucket}</p>
        </div>
      `;

      // ì“°ê¸° í…ŒìŠ¤íŠ¸
      document.getElementById("testWrite").onclick = async () => {
        try {
          log("Firestore ì“°ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘...");
          const testData = {
            test: true,
            message: "Firebase ì—°ê²° í…ŒìŠ¤íŠ¸",
            timestamp: serverTimestamp(),
          };
          const docRef = await addDoc(collection(db, "test"), testData);
          log(`âœ… ì“°ê¸° ì„±ê³µ! ë¬¸ì„œ ID: ${docRef.id}`, "success");
        } catch (error) {
          log(`âŒ ì“°ê¸° ì‹¤íŒ¨: ${error.message}`, "error");
          log(`ì—ëŸ¬ ì½”ë“œ: ${error.code}`, "error");
        }
      };

      // ì½ê¸° í…ŒìŠ¤íŠ¸
      document.getElementById("testRead").onclick = async () => {
        try {
          log("Firestore ì½ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘...");
          const querySnapshot = await getDocs(collection(db, "test"));
          log(`âœ… ì½ê¸° ì„±ê³µ! ${querySnapshot.size}ê°œ ë¬¸ì„œ ë°œê²¬`, "success");
          querySnapshot.forEach((doc) => {
            log(`  - ë¬¸ì„œ ID: ${doc.id}`);
          });
        } catch (error) {
          log(`âŒ ì½ê¸° ì‹¤íŒ¨: ${error.message}`, "error");
          log(`ì—ëŸ¬ ì½”ë“œ: ${error.code}`, "error");
        }
      };

    } catch (error) {
      log(`âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨: ${error.message}`, "error");
      statusEl.innerHTML = `
        <div class="text-red-600 font-semibold mb-2">âŒ Firebase ì—°ê²° ì‹¤íŒ¨</div>
        <div class="text-sm text-slate-600">
          <p>${error.message}</p>
        </div>
      `;
    }
  </script>
</body>
</html>

